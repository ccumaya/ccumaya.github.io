<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>DES / 3DES - JavaScript Crypto Library</title>
<!-- http://etherhack.co.uk/symmetric/des_3des/des_3des.html -->
<!-- https://developer.mozilla.org/en-US/docs/Web/API/Window.btoa -->

</head>
<!-- body onload="nowLoaded();" -->
<body>
<!-- 將所有js檔案合一，放入body區段 -->
<!-- 拆textarea為頭尾 -->
<!-- javascript壓縮( Microsoft Ajax Minifier version 4.47) http://www.lotterypost.com/js-compress.aspx -->

<script type="text/javascript">

function cyclicShiftLeft(n,t){var i=n.slice(0,t);return n=n.slice(t).concat(i)}function xtime(n){return n<<=1,n&256?n^283:n}function mult_GF256(n,t){for(var r=0,i=1;i<256;i*=2,t=xtime(t))n&i&&(r^=t);return r}function byteSub(n,t){for(var r,u=t=="encrypt"?SBox:SBoxInverse,i=0;i<4;i++)for(r=0;r<Nb;r++)n[i][r]=u[n[i][r]]}function shiftRow(n,t){for(var i=1;i<4;i++)n[i]=t=="encrypt"?cyclicShiftLeft(n[i],shiftOffsets[Nb][i]):cyclicShiftLeft(n[i],Nb-shiftOffsets[Nb][i])}function mixColumn(n,t){for(var u=[],i,r=0;r<Nb;r++){for(i=0;i<4;i++)u[i]=t=="encrypt"?mult_GF256(n[i][r],2)^mult_GF256(n[(i+1)%4][r],3)^n[(i+2)%4][r]^n[(i+3)%4][r]:mult_GF256(n[i][r],14)^mult_GF256(n[(i+1)%4][r],11)^mult_GF256(n[(i+2)%4][r],13)^mult_GF256(n[(i+3)%4][r],9);for(i=0;i<4;i++)n[i][r]=u[i]}}function addRoundKey(n,t){for(var i=0;i<Nb;i++)n[0][i]^=t[i]&255,n[1][i]^=t[i]>>8&255,n[2][i]^=t[i]>>16&255,n[3][i]^=t[i]>>24&255}function keyExpansion(n){var r=[],i,t;for(Nk=keySizeInBits/32,Nb=blockSizeInBits/32,Nr=roundsArray[Nk][Nb],t=0;t<Nk;t++)r[t]=n[4*t]|n[4*t+1]<<8|n[4*t+2]<<16|n[4*t+3]<<24;for(t=Nk;t<Nb*(Nr+1);t++)i=r[t-1],t%Nk==0?i=(SBox[i>>8&255]|SBox[i>>16&255]<<8|SBox[i>>24&255]<<16|SBox[i&255]<<24)^Rcon[Math.floor(t/Nk)-1]:Nk>6&&t%Nk==4&&(i=SBox[i>>24&255]<<24|SBox[i>>16&255]<<16|SBox[i>>8&255]<<8|SBox[i&255]),r[t]=r[t-Nk]^i;return r}function Round(n,t){byteSub(n,"encrypt"),shiftRow(n,"encrypt"),mixColumn(n,"encrypt"),addRoundKey(n,t)}function InverseRound(n,t){addRoundKey(n,t),mixColumn(n,"decrypt"),shiftRow(n,"decrypt"),byteSub(n,"decrypt")}function FinalRound(n,t){byteSub(n,"encrypt"),shiftRow(n,"encrypt"),addRoundKey(n,t)}function InverseFinalRound(n,t){addRoundKey(n,t),shiftRow(n,"decrypt"),byteSub(n,"decrypt")}function encrypt(n,t){var i;if(n&&n.length*8==blockSizeInBits&&t){for(n=packBytes(n),addRoundKey(n,t),i=1;i<Nr;i++)Round(n,t.slice(Nb*i,Nb*(i+1)));return FinalRound(n,t.slice(Nb*Nr)),unpackBytes(n)}}function decrypt(n,t){var i;if(n&&n.length*8==blockSizeInBits&&t){for(n=packBytes(n),InverseFinalRound(n,t.slice(Nb*Nr)),i=Nr-1;i>0;i--)InverseRound(n,t.slice(Nb*i,Nb*(i+1)));return addRoundKey(n,t),unpackBytes(n)}}function byteArrayToHex(n){var i="",t;if(n){for(t=0;t<n.length;t++)i+=(n[t]<16?"0":"")+n[t].toString(16);return i}}function hexToByteArray(n){var i,t;if((n.indexOf("0x")==0||n.indexOf("0X")==0)&&(n=n.substring(2)),n=n.replace(/[^A-Fa-f0-9]/g,""),!(n.length%2)){for(i=[],t=0;t<n.length;t+=2)i[Math.floor(t/2)]=parseInt(n.slice(t,t+2),16);return i}}function packBytes(n){var i=[],t;if(n&&!(n.length%4)){for(i[0]=[],i[1]=[],i[2]=[],i[3]=[],t=0;t<n.length;t+=4)i[0][t/4]=n[t],i[1][t/4]=n[t+1],i[2][t/4]=n[t+2],i[3][t/4]=n[t+3];return i}}function unpackBytes(n){for(var t=[],i=0;i<n[0].length;i++)t[t.length]=n[0][i],t[t.length]=n[1][i],t[t.length]=n[2][i],t[t.length]=n[3][i];return t}function formatPlaintext(n){var i=blockSizeInBits/8,t;if(!(typeof n=="object"&&typeof n[0]=="number")&&(typeof n=="string"||n.indexOf))for(n=n.split(""),t=0;t<n.length;t++)n[t]=n[t].charCodeAt(0)&255;return t=n.length%i,t>0&&(n=n.concat(getRandomBytes(i-t))),n}function getRandomBytes(n){for(var i=[],t=0;t<n;t++)i[t]=prng.nextInt(255);return i}function rijndaelEncrypt(n,t,i){var s,o,r=blockSizeInBits/8,u,f,e;if(n&&t&&t.length*8==keySizeInBits){for(i=="CBC"?u=getRandomBytes(r):(i="ECB",u=[]),n=formatPlaintext(n),s=keyExpansion(t),f=0;f<n.length/r;f++){if(o=n.slice(f*r,(f+1)*r),i=="CBC")for(e=0;e<r;e++)o[e]^=u[f*r+e];u=u.concat(encrypt(o,s))}return u}}function rijndaelDecrypt(n,t,i){var o,r=blockSizeInBits/8,f=[],s,u,e;if(n&&t&&typeof n!="string"&&t.length*8==keySizeInBits){for(i||(i="ECB"),o=keyExpansion(t),u=n.length/r-1;u>0;u--)if(s=decrypt(n.slice(u*r,(u+1)*r),o),i=="CBC")for(e=0;e<r;e++)f[(u-1)*r+e]=s[e]^n[(u-1)*r+e];else f=s.concat(f);return i=="ECB"&&(f=decrypt(n.slice(0,r),o).concat(f)),f}}function AESprng(n){var t,r,i;for(this.key=[],this.key=n,this.itext=hexToByteArray("9F489613248148F9C27945C6AE62EECA3E3367BB14064E4E6DC67A9F28AB3BD1"),this.nbytes=0,this.next=AESprng_next,this.nextbits=AESprng_nextbits,this.nextInt=AESprng_nextInt,this.round=AESprng_round,bsb=blockSizeInBits,blockSizeInBits=256,t=0;t<3;t++)this.key=rijndaelEncrypt(this.itext,this.key,"ECB");for(i=1+(this.key[3]&2)+(this.key[9]&1),t=0;t<i;t++)this.key=rijndaelEncrypt(this.itext,this.key,"ECB");blockSizeInBits=bsb}function AESprng_round(){bsb=blockSizeInBits,blockSizeInBits=256,this.key=rijndaelEncrypt(this.itext,this.key,"ECB"),this.nbytes=32,blockSizeInBits=bsb}function AESprng_next(){return this.nbytes<=0&&this.round(),this.key[--this.nbytes]}function AESprng_nextbits(n){for(var i=0,r=Math.floor((n+7)/8),t=0;t<r;t++)i=i<<8|this.next();return i&(1<<n)-1}function AESprng_nextInt(n){for(var t=1,r=0,i;n>=t;)t<<=1,r++;for(t--;;)if(i=this.nextbits(r)&t,i<=n)return i}function des(n,t,i,r,u,f){var et=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],lt=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],ct=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],ut=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],ft=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],ot=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],st=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],ht=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696],b=des_createKeys(n),h=0,w,c,e,at,p,y,s,o,v,a,it,l,tt,nt,g,k=t.length,d=0,rt=b.length==32?3:9;for(v=rt==3?i?[0,32,2]:[30,-2,-2]:i?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],f==2?t+="        ":f==1?(e=8-k%8,t+=String.fromCharCode(e,e,e,e,e,e,e,e),e==8&&(k+=8)):f||(t+="\x00\x00\x00\x00\x00\x00\x00\x00"),result="",tempresult="",r==1&&(a=u.charCodeAt(h++)<<24|u.charCodeAt(h++)<<16|u.charCodeAt(h++)<<8|u.charCodeAt(h++),l=u.charCodeAt(h++)<<24|u.charCodeAt(h++)<<16|u.charCodeAt(h++)<<8|u.charCodeAt(h++),h=0);h<k;){for(s=t.charCodeAt(h++)<<24|t.charCodeAt(h++)<<16|t.charCodeAt(h++)<<8|t.charCodeAt(h++),o=t.charCodeAt(h++)<<24|t.charCodeAt(h++)<<16|t.charCodeAt(h++)<<8|t.charCodeAt(h++),r==1&&(i?(s^=a,o^=l):(it=a,tt=l,a=s,l=o)),e=(s>>>4^o)&252645135,o^=e,s^=e<<4,e=(s>>>16^o)&65535,o^=e,s^=e<<16,e=(o>>>2^s)&858993459,s^=e,o^=e<<2,e=(o>>>8^s)&16711935,s^=e,o^=e<<8,e=(s>>>1^o)&1431655765,o^=e,s^=e<<1,s=s<<1|s>>>31,o=o<<1|o>>>31,c=0;c<rt;c+=3){for(nt=v[c+1],g=v[c+2],w=v[c];w!=nt;w+=g)p=o^b[w],y=(o>>>4|o<<28)^b[w+1],e=s,s=o,o=e^(lt[p>>>24&63]|ut[p>>>16&63]|ot[p>>>8&63]|ht[p&63]|et[y>>>24&63]|ct[y>>>16&63]|ft[y>>>8&63]|st[y&63]);e=s,s=o,o=e}s=s>>>1|s<<31,o=o>>>1|o<<31,e=(s>>>1^o)&1431655765,o^=e,s^=e<<1,e=(o>>>8^s)&16711935,s^=e,o^=e<<8,e=(o>>>2^s)&858993459,s^=e,o^=e<<2,e=(s>>>16^o)&65535,o^=e,s^=e<<16,e=(s>>>4^o)&252645135,o^=e,s^=e<<4,r==1&&(i?(a=s,l=o):(s^=it,o^=tt)),tempresult+=String.fromCharCode(s>>>24,s>>>16&255,s>>>8&255,s&255,o>>>24,o>>>16&255,o>>>8&255,o&255),d+=8,d==512&&(result+=tempresult,tempresult="",d=0)}return result+=tempresult,result=result.replace(/\0*$/g,"")}function des_createKeys(n){var o;pc2bytes0=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],pc2bytes1=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],pc2bytes2=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],pc2bytes3=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],pc2bytes4=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],pc2bytes5=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],pc2bytes6=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],pc2bytes7=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],pc2bytes8=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],pc2bytes9=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],pc2bytes10=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],pc2bytes11=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],pc2bytes12=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],pc2bytes13=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261];var s=n.length>8?3:1,u=new Array(32*s),h=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],f,e,r=0,c=0,t;for(o=0;o<s;o++)for(left=n.charCodeAt(r++)<<24|n.charCodeAt(r++)<<16|n.charCodeAt(r++)<<8|n.charCodeAt(r++),right=n.charCodeAt(r++)<<24|n.charCodeAt(r++)<<16|n.charCodeAt(r++)<<8|n.charCodeAt(r++),t=(left>>>4^right)&252645135,right^=t,left^=t<<4,t=(right>>>-16^left)&65535,left^=t,right^=t<<-16,t=(left>>>2^right)&858993459,right^=t,left^=t<<2,t=(right>>>-16^left)&65535,left^=t,right^=t<<-16,t=(left>>>1^right)&1431655765,right^=t,left^=t<<1,t=(right>>>8^left)&16711935,left^=t,right^=t<<8,t=(left>>>1^right)&1431655765,right^=t,left^=t<<1,t=left<<8|right>>>20&240,left=right<<24|right<<8&16711680|right>>>8&65280|right>>>24&240,right=t,i=0;i<h.length;i++)h[i]?(left=left<<2|left>>>26,right=right<<2|right>>>26):(left=left<<1|left>>>27,right=right<<1|right>>>27),left&=-15,right&=-15,f=pc2bytes0[left>>>28]|pc2bytes1[left>>>24&15]|pc2bytes2[left>>>20&15]|pc2bytes3[left>>>16&15]|pc2bytes4[left>>>12&15]|pc2bytes5[left>>>8&15]|pc2bytes6[left>>>4&15],e=pc2bytes7[right>>>28]|pc2bytes8[right>>>24&15]|pc2bytes9[right>>>20&15]|pc2bytes10[right>>>16&15]|pc2bytes11[right>>>12&15]|pc2bytes12[right>>>8&15]|pc2bytes13[right>>>4&15],t=(e>>>16^f)&65535,u[c++]=f^t,u[c++]=e^t<<16;return u}function addEntropyByte(n){entropyData[edlen++]=n}function ce(){addEntropyByte(Math.floor((new Date).getMilliseconds()*255/999))}function addEntropy32(n){for(var t=0;t<4;t++)addEntropyByte(n&255),n>>=8}function addEntropyTime(){addEntropy32(+new Date)}function mouseMotionEntropy(n){mouseMotionCollect<=0&&(mouseMotionCollect=n,document.implementation.hasFeature("Events","2.0")&&document.addEventListener?document.addEventListener("mousemove",mouseMoveEntropy,!1):document.attachEvent?document.attachEvent("onmousemove",mouseMoveEntropy):(oldMoveHandler=document.onmousemove,document.onmousemove=mouseMoveEntropy))}function mouseMoveEntropy(n){n||(n=window.event),mouseMotionCollect>0&&(mouseEntropyTime--<=0&&(addEntropyByte(n.screenX&255),addEntropyByte(n.screenY&255),ce(),mouseMotionCollect--,mouseEntropyTime=(entropyData[edlen-3]^entropyData[edlen-2]^entropyData[edlen-1])%19),mouseMotionCollect<=0&&(document.removeEventListener?document.removeEventListener("mousemove",mouseMoveEntropy,!1):document.detachEvent?document.detachEvent("onmousemove",mouseMoveEntropy):document.onmousemove=oldMoveHandler))}function keyFromEntropy(){var n,t=new Array(32);for(edlen==0&&alert("Blooie!  Entropy vector void at call to keyFromEntropy."),md5_init(),n=0;n<edlen;n+=2)md5_update(entropyData[n]);for(md5_finish(),n=0;n<16;n++)t[n]=digestBits[n];for(md5_init(),n=1;n<edlen;n+=2)md5_update(entropyData[n]);for(md5_finish(),n=0;n<16;n++)t[n+16]=digestBits[n];return t}function setKey(n){for(var u=n,e="0123456789abcdefABCDEF",t="",f=!1,r,i=0;i<u.length;i++)r=u.charAt(i),e.indexOf(r)>=0?t+=r:f=!0;if(f&&alert("Error: Non-Hexadecimal character(s) found in Hexadecimal key."),t.length>keySizeInBits/4)alert("Warning: hexadecimal key exceeds "+keySizeInBits/4+" digit maximum; truncated."),t=t.slice(0,64);else while(t.length<keySizeInBits/4)t+="0";key=hexToByteArray(t)}function Generate_key(){var n,f,t="";addEntropyTime();var i=keyFromEntropy(),r=new AESprng(i),u="0123456789abcdef";for(n=0;n<64;n++)t+=u.charAt(r.nextInt(15));return t}function Encrypt_Text(n,t){var f,i;if(t.length==0)return alert("Please specify a key."),"";if(n.length==0)return alert("Nothing to encrypt!"),"";for(setKey(t),addEntropyTime(),prng=new AESprng(keyFromEntropy()),f="",i=0;i<n.length%16;i++)n+="\x00";var e=rijndaelEncrypt(n,key,"CBC"),r=byteArrayToHex(e),u="";for(r=r.split(""),i=0;i<r.length;i++)i%64==0&&i>0&&(u+="\n"),u+=r[i];return delete prng,u}function Decrypt_Text(n,t){var r,i;if(t.length==0)return alert("Please specify a key with which to decrypt the message."),"";if(n.length==0)return alert("Nothing to decrypt!"),"";setKey(t);var f=hexToByteArray(n),u=rijndaelDecrypt(f,key,"CBC"),e="";for(i=0;i<u.length;i++)e+=String.fromCharCode(u[i])+" ";for(r="",i=0;i<u.length;i++)r+=String.fromCharCode(u[i]);return(r=r.replace(/\0*$/g,""),!r)?"":r}function array(n){for(i=0;i<n;i++)this[i]=0;this.length=n}function integer(n){return n%4294967296}function shr(n,t){return n=integer(n),t=integer(t),n-2147483648>=0?(n=n%2147483648,n>>=t,n+=1073741824>>t-1):n>>=t,n}function shl1(n){return n=n%2147483648,n&!0?(n-=1073741824,n*=2,n+=2147483648):n*=2,n}function shl(n,t){n=integer(n),t=integer(t);for(var i=0;i<t;i++)n=shl1(n);return n}function and(n,t){n=integer(n),t=integer(t);var r=n-2147483648,i=t-2147483648;return r>=0?i>=0?(r&i)+2147483648:r&t:i>=0?n&i:n&t}function or(n,t){n=integer(n),t=integer(t);var r=n-2147483648,i=t-2147483648;return r>=0?i>=0?(r|i)+2147483648:(r|t)+2147483648:i>=0?(n|i)+2147483648:n|t}function xor(n,t){n=integer(n),t=integer(t);var r=n-2147483648,i=t-2147483648;return r>=0?i>=0?r^i:(r^t)+2147483648:i>=0?(n^i)+2147483648:n^t}function not(n){return n=integer(n),4294967295-n}function F(n,t,i){return or(and(n,t),and(not(n),i))}function G(n,t,i){return or(and(n,i),and(t,not(i)))}function H(n,t,i){return xor(xor(n,t),i)}function I(n,t,i){return xor(t,or(n,not(i)))}function rotateLeft(n,t){return or(shl(n,t),shr(n,32-t))}function FF(n,t,i,r,u,f,e){return n=n+F(t,i,r)+u+e,n=rotateLeft(n,f),n=n+t}function GG(n,t,i,r,u,f,e){return n=n+G(t,i,r)+u+e,n=rotateLeft(n,f),n=n+t}function HH(n,t,i,r,u,f,e){return n=n+H(t,i,r)+u+e,n=rotateLeft(n,f),n=n+t}function II(n,t,i,r,u,f,e){return n=n+I(t,i,r)+u+e,n=rotateLeft(n,f),n=n+t}function transform(n,t){var r=0,u=0,f=0,e=0,o=transformBuffer;for(r=state[0],u=state[1],f=state[2],e=state[3],i=0;i<16;i++)for(o[i]=and(n[i*4+t],255),j=1;j<4;j++)o[i]+=shl(and(n[i*4+j+t],255),j*8);r=FF(r,u,f,e,o[0],S11,3614090360),e=FF(e,r,u,f,o[1],S12,3905402710),f=FF(f,e,r,u,o[2],S13,606105819),u=FF(u,f,e,r,o[3],S14,3250441966),r=FF(r,u,f,e,o[4],S11,4118548399),e=FF(e,r,u,f,o[5],S12,1200080426),f=FF(f,e,r,u,o[6],S13,2821735955),u=FF(u,f,e,r,o[7],S14,4249261313),r=FF(r,u,f,e,o[8],S11,1770035416),e=FF(e,r,u,f,o[9],S12,2336552879),f=FF(f,e,r,u,o[10],S13,4294925233),u=FF(u,f,e,r,o[11],S14,2304563134),r=FF(r,u,f,e,o[12],S11,1804603682),e=FF(e,r,u,f,o[13],S12,4254626195),f=FF(f,e,r,u,o[14],S13,2792965006),u=FF(u,f,e,r,o[15],S14,1236535329),r=GG(r,u,f,e,o[1],S21,4129170786),e=GG(e,r,u,f,o[6],S22,3225465664),f=GG(f,e,r,u,o[11],S23,643717713),u=GG(u,f,e,r,o[0],S24,3921069994),r=GG(r,u,f,e,o[5],S21,3593408605),e=GG(e,r,u,f,o[10],S22,38016083),f=GG(f,e,r,u,o[15],S23,3634488961),u=GG(u,f,e,r,o[4],S24,3889429448),r=GG(r,u,f,e,o[9],S21,568446438),e=GG(e,r,u,f,o[14],S22,3275163606),f=GG(f,e,r,u,o[3],S23,4107603335),u=GG(u,f,e,r,o[8],S24,1163531501),r=GG(r,u,f,e,o[13],S21,2850285829),e=GG(e,r,u,f,o[2],S22,4243563512),f=GG(f,e,r,u,o[7],S23,1735328473),u=GG(u,f,e,r,o[12],S24,2368359562),r=HH(r,u,f,e,o[5],S31,4294588738),e=HH(e,r,u,f,o[8],S32,2272392833),f=HH(f,e,r,u,o[11],S33,1839030562),u=HH(u,f,e,r,o[14],S34,4259657740),r=HH(r,u,f,e,o[1],S31,2763975236),e=HH(e,r,u,f,o[4],S32,1272893353),f=HH(f,e,r,u,o[7],S33,4139469664),u=HH(u,f,e,r,o[10],S34,3200236656),r=HH(r,u,f,e,o[13],S31,681279174),e=HH(e,r,u,f,o[0],S32,3936430074),f=HH(f,e,r,u,o[3],S33,3572445317),u=HH(u,f,e,r,o[6],S34,76029189),r=HH(r,u,f,e,o[9],S31,3654602809),e=HH(e,r,u,f,o[12],S32,3873151461),f=HH(f,e,r,u,o[15],S33,530742520),u=HH(u,f,e,r,o[2],S34,3299628645),r=II(r,u,f,e,o[0],S41,4096336452),e=II(e,r,u,f,o[7],S42,1126891415),f=II(f,e,r,u,o[14],S43,2878612391),u=II(u,f,e,r,o[5],S44,4237533241),r=II(r,u,f,e,o[12],S41,1700485571),e=II(e,r,u,f,o[3],S42,2399980690),f=II(f,e,r,u,o[10],S43,4293915773),u=II(u,f,e,r,o[1],S44,2240044497),r=II(r,u,f,e,o[8],S41,1873313359),e=II(e,r,u,f,o[15],S42,4264355552),f=II(f,e,r,u,o[6],S43,2734768916),u=II(u,f,e,r,o[13],S44,1309151649),r=II(r,u,f,e,o[4],S41,4149444226),e=II(e,r,u,f,o[11],S42,3174756917),f=II(f,e,r,u,o[2],S43,718787259),u=II(u,f,e,r,o[9],S44,3951481745),state[0]+=r,state[1]+=u,state[2]+=f,state[3]+=e}function md5_init(){for(count[0]=count[1]=0,state[0]=1732584193,state[1]=4023233417,state[2]=2562383102,state[3]=271733878,i=0;i<digestBits.length;i++)digestBits[i]=0}function md5_update(n){var t,i;t=and(shr(count[0],3),63),count[0]<4294967288?count[0]+=8:(count[1]++,count[0]-=4294967296,count[0]+=8),buffer[t]=and(n,255),t>=63&&transform(buffer,0)}function md5_finish(){for(var i=new array(8),r,n=0,t=0,u=0,n=0;n<4;n++)i[n]=and(shr(count[0],n*8),255);for(n=0;n<4;n++)i[n+4]=and(shr(count[1],n*8),255);for(t=and(shr(count[0],3),63),u=t<56?56-t:120-t,r=new array(64),r[0]=128,n=0;n<u;n++)md5_update(r[n]);for(n=0;n<8;n++)md5_update(i[n]);for(n=0;n<4;n++)for(j=0;j<4;j++)digestBits[n*4+j]=and(shr(state[n],j*8),255)}function genkey(){var n=Generate_key();document.getElementById("key").value=n.slice(0,48),document.getElementById("vector").value=n.slice(48,64)}function chars_from_hex(n){var i="",t;for(n=n.replace(/^(0x)?/g,""),n=n.replace(/[^A-Fa-f0-9]/g,""),n=n.split(""),t=0;t<n.length;t+=2)i+=String.fromCharCode(parseInt(n[t]+""+n[t+1],16));return i}function hex_from_chars(n){var f="",i="",r="0123456789abcdef",u,e,t;for(r=r.split(""),e=n.split(""),t=0;t<e.length;t++)t>0&&(i+=f),!f&&t%32==0&&t>0&&(i+="\n"),u=n.charCodeAt(t),i+=r[u>>4&15]+r[u&15];return i}function encrypt_string(){var r=document.getElementById("input_ta").value,t=document.getElementById("key").value,n,i;t=chars_from_hex(t),n=document.getElementById("vector").value,n=chars_from_hex(n),n=n.length>7?n:null,i=des(t,r,1,n?1:0,n),document.getElementById("output").value=hex_from_chars(i)}function decrypt_string(){var i=document.getElementById("input_ta").value,t=document.getElementById("key").value,n;t=chars_from_hex(t),n=document.getElementById("vector").value,n=chars_from_hex(n),n=n.length>7?n:null,i=chars_from_hex(i),document.getElementById("output").value=des(t,i,0,n?1:0,n)}function swap(){var n=document.getElementById("input_ta"),t=document.getElementById("output"),i=n.value;n.value=t.value,t.value=i}var keySizeInBits=256,blockSizeInBits=128,roundsArray=[,,,,[,,,,10,,12,,14],,[,,,,12,,12,,14],,[,,,,14,,14,,14]],shiftOffsets=[,,,,[,1,2,3],,[,1,2,3],,[,1,3,4]],Rcon=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],SBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],SBoxInverse=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],Nk=keySizeInBits/32,Nb=blockSizeInBits/32,Nr=roundsArray[Nk][Nb],entropyData=[],edlen=0,mouseMotionCollect,oldMoveHandler,mouseEntropyTime,loadTime,key,prng,state,count;addEntropyTime(),ce(),mouseMotionCollect=0,mouseEntropyTime=0,loadTime=+new Date,state=new array(4),count=new array(2),count[0]=0,count[1]=0;var buffer=new array(64),transformBuffer=new array(16),digestBits=new array(16),S11=7,S12=12,S13=17,S14=22,S21=5,S22=9,S23=14,S24=20,S31=4,S32=11,S33=16,S34=23,S41=6,S42=10,S43=15,S44=21;nowLoaded(),ce(),mouseMotionEntropy(60);

</script>
<script>
function test_encode_cht()
{
  var input_ta = document.getElementById("input_ta").value;
  var b64 = utf8_to_b64(input_ta);
  
  document.getElementById("input_ta").value = b64;
    
  encrypt_string();//呼叫原函式  
}
function test_decode_cht()
{
  decrypt_string();//i->o

  var output = document.getElementById("output").value;
  var cht = b64_to_utf8(output);
  document.getElementById("output").value = cht;
}

function utf8_to_b64( str ) {
    return window.btoa(encodeURIComponent( escape( str )));
}

function b64_to_utf8( str ) {
    return unescape(decodeURIComponent(window.atob( str )));
}

</script>

<div>

<textarea id="input_ta" rows="20" cols="80" onfocus="ce();" onblur="ce();" onkeydown="ce();" >
</textarea>
<br />

<input type="button" id='btnEnCht' value="加密" onclick="test_encode_cht();" />
<input type="button" id='btnDeCht' value="解密" onclick="test_decode_cht();" />
<input type="button" id='btnSwap' value="對調" onclick="swap()" />
<input type="button" id='btnGenKey' value="生鑰" onclick="genkey();" />

<input type="text" id="key" size="48" maxlength="75" onfocus="ce();" onblur="ce();" onkeydown="ce();" />
<input type="text" id="vector" size="16" onfocus="ce();" onblur="ce();" onkeydown="ce();" />
<br />

<textarea id="output" rows="20" cols="80" onfocus="ce();" onblur="ce();" onkeydown="ce();" >
</textarea>
</div>
主架構<a href='http://etherhack.co.uk/symmetric/des_3des/des_3des.html'>取自</a>

</body></html>